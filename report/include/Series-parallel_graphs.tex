\section{Series-Parallel Graphs}\label{section:SP-graphs}

This thesis addresses two main approaches of ratio minimization for drawings of series parallel graphs. Maximal series parallel graphs refers to the class of 2-trees % TODO 2-tree<>max SP graph
and are a suitable class of interest for fundamental research since any 2-tree is biconnected, but not triconnected and inherits a constant treewidth. Furthermore, any maximal outerplanar graph is a 2-tree, therefore the class of maximal outerplanar graphs is a strict subclass of the 2-trees.\\
At first, the approaches will address the maximal outerplanar graphs. After the analysis regarding the properties of the resulting drawings it will be discussed whether the approach will be suitable to be extended for 2-trees.

% TODO properties
\begin{itemize}
	\item Biconnected only, there is no $R$ node in any SPQR tree
	\item Suitable class of interest for fundamental research
	\item Maximal SP graphs are 2-trees
	\item maximal outerplanar graphs are a subclass of 2-trees
\end{itemize}

\subsection{Outerplanar Graphs}

At first, the attention is drawn to \emph{outerplanar graphs} as they are a subclass of SP graphs. There will be two polyline drawing algorithms presented for this class of SP graphs. The first drawing algorithm will take advantage of the already existing drawing algorithm \ref{al:k-ary_trees} for $k$-ary trees, since the weak dual graph of a maximal outerplanar graph inheits a tree structure. The second drawing algorithm for outerplanar graphs will be suited to be extended for $2$-trees, since every maximal SP graph contains a maximal outerplanar graph as a subgraph.

\subsubsection{Properties Of Outerplanar Graphs}
\begin{lemma}
	A maximal outerplanar graph $G$ inherits triangles as inner faces, except for the outerface.
\end{lemma}
\begin{lemma}\label{l:outerplanar-dual-tree-degree-3}
	The weak dual graph $G^*$ of a maximal outerplanar graph $G$ is a simple tree with maximum degree 3 for any vertex.
\end{lemma}
\begin{proof}
	The weak dual graph $G^*$ is connected since $G$ is maximal outerplanar. Suppose, that $G^*$ contains a cycle $\mathcal{C}$. Then, there exists a vertex in $G$ which is enclosed from the outerface by faces according to $\mathcal{C}$ in $G^*$ and $G$ is not outerplanar. This implies that $G^*$ must be acyclic and considering the connectedness, $G^*$ is a tree. Since any face $f$ is a triangle, the degree of $v_f$ in $G^*$ values at most three. The simplicity is derived from the maximal outerplanarity property. If there were multiple edges between vertex $v_f$ and $v_{f'}$ in $G^*$, then there would be at least one vertex in $G$ which does not lie on the outerface.
\end{proof}
\begin{lemma}
	Let $G$ be a maximal outerplanar graph with $n$ vertices and $G^*$ the dual graph excluding the outerface, a rooted tree with degree up to three for every vertex $v_f$. Then, the height of $G^*$ ranges between $\Omega(\log n)$ and $\mathcal{O}(n)$.
\end{lemma}
\begin{proof}
	Since $G$ is a planar graph, it contains $\mathcal{O}(n)$ faces. The rooted tree $G^*$ inherits the following property:
	\begin{enumerate}
		\item The root has at most three children
		\item The subtrees rooted at the children of the root are binary
	\end{enumerate}
	Placing $\mathcal{O}(n)$ vertices in three binary trees connected to a root vertex results in a height of at least $\Omega(\log n)$ due to the $k$-ary tree height property from Lemma \ref{l:k-ary-tree_log_height}. In the worst case, the dual graph will be a chain of vertices, therefore a rooted tree with height $\mathcal{O}(n)$.
\end{proof}

\begin{observation}
	% TODO linear height with subtrees of constant height
\end{observation}

\begin{lemma}
	A maximal outerplanar graph $G$ can be extended to a maximal outerplanar supergraph $G'$.\label{l:outerplanar-supergraph}
\end{lemma}
\begin{proof}
	A new vertex can be added to $G$ by adding a new vertex $v_f$ in the dual graph $G^*$ so that the degree of $G^*$ is still at most 3. The newly created face $f$ must lie on the outerface and must be a triangle. Otherwise, the outerplanarity property is destroyed.
\end{proof}

% One Bend, maximal complete outerplanar graph
When $G^*$ inherits a height of $\mathcal{O}(\log n)$, a new problem emerges. When starting drawing the root of $G^*$, new vertices are added in all directions, enclosing more and more area along the iterative drawing. 

Figure bla illustrates this problem. 
% TODO Figure of area problem
This results in short euclidian distances relative to the longest edge, increasing the ratio.\\
\begin{definition}
	A maximal outerplanar graph is called \emph{complete} if its weak dual graph $G^*$ fulfills these properties:
\begin{enumerate}
	\item The root vertex has exactly three children
	\item Every other inner node has exactly two children. In other words, the subtrees adjacent to the root vertex are complete binary trees of height $h-1$
\end{enumerate}
\end{definition}

\subsubsection{Drawing A Complete Outerplanar Graph With One Bend}

A given maximal outerplanar graph can be drawn by using a drawing algorithm for its weak dual graph. In section \ref{s:k-ary_trees}, the $k$-ary tree drawing algorithm produces a straight-line drawing in $\mathcal{O}(n^2 \log n)$ area with a ratio of $1+\varepsilon,\varepsilon>0$. The drawing algorithm \ref{al:k-ary_trees} can be used with a minor modification to draw the weak dual graph of any complete maximal outerplanar graph $G$, since $G^*$ is a subtree of a $3$-ary tree with the same height.\\

\begin{algorithm}[H]
	\KwIn{A complete maximal outerplanar graph $G$}
	\KwOut{Straight-line drawing $\Gamma_{G^*}$ with nearly optimal ratio}
	\caption{\texttt{DrawOuterWeakDual($G$)}}\label{al:drawouterweakdual}
	$G^* \gets$ weak dual graph of $G$ with minimal height\\
	$h \gets$ \texttt{height($G^*$)}\\
	\texttt{root} $\gets$ $G^*$.\texttt{root}\\
	\texttt{Draw(root)}\\
	\texttt{Draw\_$3$-ary\_Children(\texttt{root},$3^h$,1)}\\
	\For{\texttt{$v \in$ root.children}}{
		\texttt{Draw\_$2$-ary\_Children($v$,$2^{h-1}$,$h-1$)}
	}
	\Return $\Gamma$
\end{algorithm}

Algorithm \ref{al:drawouterweakdual} produces a nearly optimal straight-line drawing for the weak dual graph of a complete outerplanar graph $G$. The resulting drawing $\Gamma_{G^*}$ provides assistance to draw the complete outerplanar graph $G$. Every vertex of $\Gamma_{G^*}$ serves as an anchor point for the drawing of its corresponding face in $G$.\\
Starting at the root of $G^*$, a triangle is drawn around the root in a way, that each edge of $G^*$ from the root to its three children crosses exactly one edge of the corresponding triangle face in $G$. The vertices for the triangle are placed as follows. The first vertex lies above the already drawn root with an euclidian distance to the root sufficiently high in order to preserve planarity for the remaining drawing. The other two vertices are placed inbetween the two triangles defined by the root, its $\{\text{left, right}\}$ and middle children.\\
In order to guarantee a valid vertex and bend placement at every inner node $v^*$, the drawing is stretched horizontally by a factor of three.\\
Then, the drawing algorithm iterates over the height of $G^*$. For every vertex $v^*$ of height $i\in \{1,...,h\}$ in $G^*$, two bend points are placed 1 \UL left and right from $\Gamma_{G^*}(v^*)$, and the new vertex $v$ is placed 1 \UL below from $\Gamma_{G^*}(v^*)$.\\
$v^*$ is adjacent to an edge $e^*$ defined in $G^*$ that is crossing exactly one edge $e = (v_1,v_2)$ of $G$. This crossing corresponds to the vertices defining the new face, $\{v, v_1, v_2\}$. Since $G^*$ consists of three complete binary subtrees connected to the root, using the bends to draw the new face will preserve planarity since the coordinate of every inner node inherits its unique $x$ value by construction of algorithm \ref{al:k-ary_trees}. 
% TODO illustration of the approach
This drawing approach is summarized in the following algorithm.\\
\begin{algorithm}[H]
	\KwIn{Complete outerplanar graph $G$}
	\KwOut{Polyline drawing $\Gamma_G$ with one bend per edge and ratio $\mathcal{O}(\log n)$}
	\caption{\texttt{DrawCompleteOuterplanar($G$)}}\label{al:complete_outerplanar}
	$\Gamma \gets $ \texttt{DrawOuterWeakDual($G$)}\\
	$h \gets$ \texttt{height($G^*$)}\\
	\For{$v^* \in G^*$}{
		$x(v^*) \gets 3\cdot x(v^*)$
	}
	\tcc{Draw the triangle face around the root of ${G^*}$}
	$root \gets$ $\Gamma(G^*.\texttt{root})$\\
	$l \gets$ $\Gamma(G^*.\texttt{root.leftChild})$\\
	$m \gets$ $\Gamma(G^*.\texttt{root.middleChild})$\\
	$r \gets$ $\Gamma(G^*.\texttt{root.rightChild})$\\
	$v_1 \gets$ $\Gamma$.\texttt{PlaceVertex($x(root),y(root)+h\cdot 3^h$)}\\
	$v_2 \gets$ $\Gamma$.\texttt{PlaceVertex($\frac{x(root)+x(l)+x(m)}{3},\frac{y(root)+y(l)+y(m)}{3}$)}\\
	$v_3 \gets$ $\Gamma$.\texttt{PlaceVertex($\frac{x(root)+x(m)+x(r)}{3},\frac{y(root)+y(m)+y(r )}{3}$)}\\
	$\Gamma$.\texttt{DrawLineSegment($v_1,v_2$)}\\
	$\Gamma$.\texttt{DrawLineSegment($v_1,v_3$)}\\
	$\Gamma$.\texttt{DrawLineSegment($v_3,v_2$)}\\
	
	\tcc{Iterate over the height to draw the remaining vertices of $G$}
	\For{$i \in [1..h]$}{
		\For{$v^* \in G^*$ with height $i$}{
			$b_l \gets$ $\Gamma$.\texttt{PlaceBendPoint($x(v^*) - 1,y(v^*)$)}\\
			$b_r \gets$ $\Gamma$.\texttt{PlaceBendPoint($x(v^*) + 1,y(v^*)$)}\\
			$v \gets$ $\Gamma$.\texttt{PlaceVertex($x(v^*),y(v^*)-1$)}\\
			$e^* \gets (v^*,\texttt{parent}(v^*))$\\
			$e \gets (v_1, v_2)$ edge intersecting $e^*$
			\tcp{w.l.o.g. $v_1$ ordered left of $v_2$}
			$\Gamma.$\texttt{DrawLineSegment($v,b_l$)}\\
			$\Gamma.$\texttt{DrawLineSegment($b_l,v_1$)}\\
			$\Gamma.$\texttt{DrawLineSegment($v,b_r$)}\\
			$\Gamma.$\texttt{DrawLineSegment($b_r,v_2$)}
		}
	}
	$\Gamma$\texttt{.delete($G^*$)}\\
	\Return $\Gamma$
\end{algorithm}


\subsubsection{Analysis Of Algorithm \ref{al:complete_outerplanar}}

\begin{lemma}
	Every complete outerplanar graph $G$ admits a polyline drawing $\Gamma_G$ on $\mathcal{O}(n^2 \log n)$ area with one bend per edge. The drawing is constructed in linear time and the ratio lies in $\mathcal{O}(h)$, whereas $h$ describes the height of $G^*$.
\end{lemma}

\begin{proof}
The triangle around the root of $G^*$ consists of a vertex $v_1$ placed atop of the root vertex with distance $h\cdot r^h$ and two vertices $v_2,v_3$ placed at the centroids of the triangles defined by $\{\texttt{root,root.leftChild,root.middleChild}\}$ and $\{\texttt{root,root.middleChild,root.rightChild}\}$. By construction it holds, that $v_2$ and $v_3$ partition three binary subtrees rooted at the children of the root of $G^*$ by their $x$ coordinate. The placement of the vertices $v_1,v_2$ and $v_3$ guarantee exactly one intersection between an edge of $G$ and an edge of $G^*$ in $\Gamma$.\\
After stretching the drawing horizontally by a factor of three, there exist free grid points next to every vertex of $G^*$ which guarantees a grid point placement left and right of any vertex $v^*$. During the iteration over the height starting at height 1, every intersection between an edge of $G^*$ and $G$ refer to vertices on the outerface and a new face of $G$ is attached on the outerface, preserving the outerplanarity of the drawing.\\
Since $v_1$ is placed with a distance of $h\cdot r^h$ atop of the root of $G^*$ and $v_2$ and $v_3$ partition the $x$ coordinate of the binary subtrees rooted at the children of the root of $G^*$, planarity is preserved.\\
The total height of the drawing is doubled and the width is tripled compared to a drawing of a $3$-ary tree, therefore the area consumption lies still in $\mathcal{O}(n^2 \log n)$.\\
The construction of $G^*$ with minimal height lies in $\mathcal{O}(n)$ since there are $\mathcal{O}(n)$ faces for any maximal outerplanar graph. Drawing $G^*$ and $G$ lies in $\mathcal{O}(n)$. The runtime of this algorithm is therefore in linear time.\\
The minimal euclidian distance values at least $2^h$ by construction of algorithm \ref{al:k-ary_trees} and lies in $\mathcal{O}(n)$. The length of the longest polyline spans the whole height of the drawing and lies in $\mathcal{O}(n \log n)$. The ratio lies therefore in $\mathcal{O}(h)$ with $h$ describing the height of $G^*$.
\end{proof}
\subsubsection{Example Drawing}

% TODO example drawing of complete outerplanar graph

\subsubsection{Limitations}
\begin{itemize}
	\item Not suitable for 2-trees, weak dual graph not simple anymore
	\item Approach draws dense maximal outerplanar graphs with a good ratio but draws loose maximal outerplanar graphs with a bad ratio, $\mathcal{O})(n)$ in the worst case.
\end{itemize}

\subsection{Series Parallel Graphs}

\begin{itemize}
	\item A layering in a drawing algorithm will guarantee a minimal euclidian distance between two adjacent vertices by defining a minimal distance between two layers
	\item weak dual graph is not sufficient for 2-trees since it is not simple anymore
	\item Usage of tree decomposition of a given 2-tree, then creating the SQPR tree and then draw it
\end{itemize}

\subsubsection{Properties Of Series Parallel Graphs}

\subsubsection{Drawing An Outerplanar Graph With Two Bends}

\subsubsection{Analysis}

\subsubsection{Example drawing}

\subsubsection{Drawing A $2$-Tree With Two Bends}

\subsubsection{Analysis}

\subsubsection{Example drawing}

% TODO What is this section about?

% TODO sei vorsichtig bezüglich multigraph / simple graph, wenn es um die zeichnung laut SPQR tree geht. Erst, definieren, was bei Q, dann bei S, dann bei P, dann bei R. 